/**
 * @copyright   Copyright Â© 2024 Blue-Coder.com. All rights reserved.
 * @license     GNU General Public License 2 or later, see COPYING.txt for license details.
 */
"use strict";window.JFilters=window.JFilters||{},JFilters.range_inputs={},JFilters.range_inputs.update=(e,t)=>{const i=e.moduleId,r=e.filterId,l=e.baseUrl,n=e.filterAlias;if(!l||!n)return!1;const a=e.urlFormat?e.urlFormat:"path";let s="";s=JFilters.filteringModule.instances[i].filters[r].createUrl(t,l,n,a);let u=!1;return JFilters.filteringModule.instances[i].filters[r]&&(u=JFilters.filteringModule.instances[i].filters[r].update(s,!JFilters.filteringModule.instances[i].submitWithButton)),u||window.location.assign(s),!0},JFilters.range_inputs.getValues=e=>{let t={};return[].slice.call(e.querySelectorAll(".jfilters-filter-range_inputs__input")).forEach(((e,i)=>{t[0==i?"min":"max"]=e.value})),t},JFilters.range_inputs.setValues=(e,t)=>([].slice.call(e.querySelectorAll(".jfilters-filter-range_inputs__input")).forEach(((e,i)=>{let r=0==i?"min":"max";e.value=t[r]})),!0),JFilters.range_inputs.validateInput=(e,t)=>{let i=!0,r="",l=JFilters.range_inputs.getValues(e);const n=l.min.match(/^[+-]?\d+(\.\d*)?$/),a=l.max.match(/^[+-]?\d+(\.\d*)?$/),s=e.querySelector(".jfilters-filter__submit-btn");if(n||a)s&&s.removeAttribute("disabled"),r="";else{s&&s.setAttribute("disabled","disabled"),("min"===t?n:a)||(r=Joomla.Text._("MOD_JFILTERS_FILTER_ALERT_MSG_ONLY_NUMERICAL_VALUES")),i=!1}const u=e.parentElement.querySelector(".jfilters-filter__alert");return u&&(u.innerText=r),i},JFilters.range_inputs.validateRange=(e,t)=>{let i=!0,r="",l=JFilters.range_inputs.getValues(e);parseFloat(l.min)>parseFloat(l.max)&&(i=!1,r=Joomla.Text._("MOD_JFILTERS_FILTER_ALERT_MSG_MAX_LOWER_TO_MIN")),""!=t.minLimit&&""!=t.maxLimit&&(parseFloat(l.min)<t.minLimit||parseFloat(l.min)>t.maxLimit||parseFloat(l.max)<t.minLimit||parseFloat(l.max)>t.maxLimit)?(i=!1,r=Joomla.Text._("MOD_JFILTERS_FILTER_ALERT_MSG_INSERTED_VALUES_BETWEEN"),r=r.replace(/%[ds]/,t.minLimit),r=r.replace(/%[ds]/,t.maxLimit)):""!=t.minLimit&&""==t.maxLimit&&(parseFloat(l.min)<t.minLimit||parseFloat(l.max)<t.minLimit)?(i=!1,r=Joomla.Text._("MOD_JFILTERS_FILTER_ALERT_MSG_INSERTED_VALUES_HIGHER_THAN").replace(/%[ds]/,t.minLimit)):""==t.minLimit&&""!=t.maxLimit&&(parseFloat(l.min)>t.maxLimit||parseFloat(l.max)>t.maxLimit)&&(i=!1,r=Joomla.Text._("MOD_JFILTERS_FILTER_ALERT_MSG_INSERTED_VALUES_LOWER_THAN").replace(/%[ds]/,t.maxLimit));const n=e.parentElement.querySelector(".jfilters-filter__alert");return n&&(n.innerText=r),i},JFilters.range_inputs.boot=()=>{const e=Joomla.getOptions("jfilters.filter");void 0!==e&&e.forEach((e=>{if(!e.extraProperties||"range_inputs"!=e.extraProperties.type&&("range_sliders"!=e.extraProperties.type||!0!==e.extraProperties.withInputs))return;let t=e.extraProperties;const i=window.JFilters.filteringModule.moduleWrapperSelectorPrefix+e.moduleId,r=document.querySelector(i);if(!r)return;let l={filterId:e.id,moduleId:e.moduleId,filterAlias:t.alias,baseUrl:t.baseUrl,urlFormat:t.urlFormat,minLimit:t.minValue,maxLimit:t.maxValue};const n=r.querySelector("#jfilters-filter-range_inputs-"+e.moduleId+"-"+e.id);if(!n.rangeInputs){JFilters.range_inputs.addEvents(n);const e=n.querySelector(".jfilters-filter__submit-btn");e&&e.addEventListener("click",(()=>{if(JFilters.range_inputs.validateRange(n,l)){let e=JFilters.range_inputs.getValues(n);e=[e.min,e.max],JFilters.range_inputs.update(l,e)}}))}n.rangeInputs=!0}))},JFilters.range_inputs.addEvents=e=>{const t=[].slice.call(e.querySelectorAll(".jfilters-filter-range_inputs__input")),i=2===t.length?t[0]:null,r=2===t.length?t[1]:null,l=e.classList.contains("jfilters-filter-range_inputs--withSlider");i&&r&&(i.addEventListener("input",(function(){if(JFilters.range_inputs.validateInput(e,"min")&&l){const t=e.parentNode.querySelector(".jfilters-filter-range-sliders");if(t&&void 0!==t.rangeSliders){let i=JFilters.range_inputs.getValues(e);t.rangeSliders.setMin(i.min)}}i.listenerAttached=!0})),r.addEventListener("input",(function(){if(JFilters.range_inputs.validateInput(e,"max")&&l){const t=e.parentNode.querySelector(".jfilters-filter-range-sliders");if(t&&void 0!==t.rangeSliders){let i=JFilters.range_inputs.getValues(e);t.rangeSliders.setMax(i.max)}}})))},document.addEventListener("DOMContentLoaded",JFilters.range_inputs.boot);
