/**
 * @copyright   Copyright Â© 2024 Blue-Coder.com. All rights reserved.
 * @license     GNU General Public License 2 or later, see COPYING.txt for license details.
 */
"use strict";window.JFilters=window.JFilters||{},JFilters.calendar={},JFilters.calendar.update=(e,t)=>{const o=e.config.moduleId,a=e.config.filterId,l=e.config.baseUrl,r=e.config.filterAlias;if(!l||!r)return!1;const i=e.config.urlFormat?e.config.urlFormat:"path";let n="",s=[];if("range"==e.config.mode){if(e.selectedDates.length<2)return!1;s=t.split(e.l10n.rangeSeparator)}else s=[t];n=JFilters.filteringModule.instances[o].filters[a].createUrl(s,l,r,i);let T=!1;return JFilters.filteringModule.instances[o].filters[a]&&(T=JFilters.filteringModule.instances[o].filters[a].update(n,!JFilters.filteringModule.instances[o].submitWithButton)),T||window.location.assign(n),!0},JFilters.calendar.localize=e=>{let t={weekdays:{shorthand:[Joomla.Text._("SUN"),Joomla.Text._("MON"),Joomla.Text._("TUE"),Joomla.Text._("WED"),Joomla.Text._("THU"),Joomla.Text._("FRI"),Joomla.Text._("SAT")],longhand:[Joomla.Text._("SUNDAY"),Joomla.Text._("MONDAY"),Joomla.Text._("TUESDAY"),Joomla.Text._("WEDNESDAY"),Joomla.Text._("THURSDAY"),Joomla.Text._("FRIDAY"),Joomla.Text._("SATURDAY")]},months:{shorthand:[Joomla.Text._("JANUARY_SHORT"),Joomla.Text._("FEBRUARY_SHORT"),Joomla.Text._("MARCH_SHORT"),Joomla.Text._("APRIL_SHORT"),Joomla.Text._("MAY_SHORT"),Joomla.Text._("JUNE_SHORT"),Joomla.Text._("JULY_SHORT"),Joomla.Text._("AUGUST_SHORT"),Joomla.Text._("SEPTEMBER_SHORT"),Joomla.Text._("OCTOBER_SHORT"),Joomla.Text._("NOVEMBER_SHORT"),Joomla.Text._("DECEMBER_SHORT")],longhand:[Joomla.Text._("JANUARY"),Joomla.Text._("FEBRUARY"),Joomla.Text._("MARCH"),Joomla.Text._("APRIL"),Joomla.Text._("MAY"),Joomla.Text._("JUNE"),Joomla.Text._("JULY"),Joomla.Text._("AUGUST"),Joomla.Text._("SEPTEMBER"),Joomla.Text._("OCTOBER"),Joomla.Text._("NOVEMBER"),Joomla.Text._("DECEMBER")]},firstDayOfWeek:void 0!==e.firstday?e.firstday:1,ordinal:function(){return""},rangeSeparator:" "+Joomla.Text._("MOD_JFILTERS_FILTER_DATE_RANGE_SEPARATOR")+" ",weekAbbreviation:Joomla.Text._("JLIB_HTML_BEHAVIOR_WK"),amPM:[Joomla.Text._("JLIB_HTML_BEHAVIOR_AM"),Joomla.Text._("JLIB_HTML_BEHAVIOR_PM")]};flatpickr.l10ns.jl=t,flatpickr.localize(t)},JFilters.calendar.setActiveDates=(e,t,o,a=!0)=>{const l=e.formatDate(o.dateObj,"Y-m-d");t&&t.forEach((e=>{e.value==l&&void 0!==e.counter&&parseInt(e.counter)>0&&(o.classList.add("jfilters-filter-calendar__date--active"),a&&(o.innerHTML+=`<span class="jfilters-filter-calendar__date-counter" role="note" aria-label="${Joomla.Text._("MOD_JFILTERS_NUMBER_OF_ITEMS")}">${e.counter}</span>`))}))},JFilters.calendar.boot=()=>{const e=Joomla.getOptions("jfilters.filter");void 0!==e&&"undefined"!=typeof flatpickr&&(JFilters.calendar.localize({}),e.forEach((e=>{if(!e.extraProperties||"calendar"!=e.extraProperties.type)return;let t=e.extraProperties;const o=window.JFilters.filteringModule.moduleWrapperSelectorPrefix+e.moduleId,a=document.querySelector(o);if(!a)return;let l=t.wrapperSelector?t.wrapperSelector:".jfilters-filter-calendar";const r=[].slice.call(a.querySelectorAll(l));let i={filterId:e.id,moduleId:e.moduleId,filterAlias:t.alias,baseUrl:t.baseUrl,urlFormat:t.urlFormat,mode:t.calendarMode,wrap:!0,altInput:!0,altFormat:t.visualFormat?t.visualFormat:"d M, Y",showCounter:"1"==t.showCounter,minDate:t.minDate,maxDate:t.maxDate,weekNumbers:"1"==t.weekNumbers,enableTime:"1"==t.enableTime,time_24hr:"1"==t.time_24hr};r.forEach((e=>{i.onChange=function(e,t,o){JFilters.calendar.update(o,t)},i.onDayCreate=function(e,o,a,l){const r=t.values;JFilters.calendar.setActiveDates(a,r,l,i.showCounter)},flatpickr(e,i)}))})))},document.addEventListener("DOMContentLoaded",JFilters.calendar.boot);
